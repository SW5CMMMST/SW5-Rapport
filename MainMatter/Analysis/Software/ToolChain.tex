%Af: SÃ¸ren (?)
%1st review: Troels
%2nd review Morten
\subsection{Toolchain}
When programming for the Arduino it is possible to use the Arduino IDE developed by the Arduino company.
This IDE uses a specific version of the GCC compiler which targets the AVR microcontrollers.
The C or C++ code is first checked for errors and compiled to object code, which is then linked with the standard Arduino libraries and any custom libraries.
The linked object code is then compiled to a single Intel Hex file, which is loaded onto the Arduino using the bootloader already situated on the microcontroller.
A USB to serial converter is also implemented on most of the Arduino boards since it is through the serial connection that the microcontroller communicates e.g. debugging.
This toolchain is also shown on \myref{fig:arduino_flow}. 
See \cite{2015ArduinoToolchain} for more information about the Arduino Toolchain.

\tikzfigure{ArduinoFlowDiagram}{Flow diagram showing the flow of the source files onto the Arduino}{arduino_flow}

\noindent
To show how to upload code to an Arduino some screenshots of the Arduino IDE have been taken.
To upload any code to the Arduino the kind of Arduino being used has to be specified; how to do this can be seen on \myref{fig:choose_arduino}.

The USB-hub where the Arudino is plugged in must be specified, a screenshot of this can be seen on figure \myref{fig:choose_port}.

When the code is ready to be uploaded to the Arduino a simple press of the arrow in the top of the IDE will upload and run the code as can be seen on \myref{fig:serial_monitor}. 
The code being run in this screenshot is a simple program which turns on an LED on pin 13 of the Arduino with a varying delay, which is also printed to the serial monitor.
The serial monitor is of great use when debugging with the Arduino as it makes it possible to know what values different variables of the program have at run-time.

The code is split into three parts.
The function \texttt{setup()} is run once when the program starts, and this is where different pins are often set to be input or output.
The function \texttt{loop()} is then run as long as the Arduino is turned on. 
The last part in this example is a global variable \texttt{int i} which is set to global in this simple example.

It is also possible to code in other languages for the Arduino as long as a compiler which compiles for the AVR processor is used, e.g. Java.
NanoVM is an implementation of some of the Java virtual machine for the AVR processor, it does not contain all its features because of the limited resources the microcontrollers possess. 
According to the creator, see \cite{NanoVM}, NanoVM will never contain all the features of the JVM, and C is still a much more powerful language when working with microcontrollers. 


\begin{figure}[!ht]
    \begin{subfigure}{0.47\linewidth}
        \centering
        \includegraphics[width=\linewidth]{Figures/ChooseArduino.png}
        \caption{Choose Arduino}
        \label{fig:choose_arduino}
    \end{subfigure}\hfill
    \begin{subfigure}{0.47\linewidth}
        \centering
        \includegraphics[width=\linewidth]{Figures/ChoosePort.png}
        \caption{Choose Port}
        \label{fig:choose_port}
    \end{subfigure}\\[1ex]
    \begin{subfigure}{\linewidth}
        \centering
        \includegraphics[width=0.47\linewidth]{Figures/SerialMonitor}
        \caption{Serial monitor after uploading code}
        \label{fig:serial_monitor}
    \end{subfigure}
    \caption{Screenshots from the Arduino IDE.}
    \label{fig:ArduinoScreenshots}
\end{figure}
