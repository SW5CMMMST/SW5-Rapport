%author:        Morten
%1st review:    Marc
\subsection{Radio Frequency Module Test}\todo{Dette afsnit skal gennemarbejdes fra bunden igen.}
In this section the RF module will be tested.
These tests are performed for a couple of reasons.
Firstly these tests will give an impression of how reliable the hardware is and what capabilities can be expected from the RF module. 
Secondly the testing allows the group to familiarise themselves with the hardware used for the project.

The RF module, described in \myref{rfmodule}, will be tested in a few aspects. 
First the RF modules receiver will be tested for noise pickup.
This will be done without any library for the RF module.
This will simply be done by making the receiver try to read from the datapin, the results will help reveal how much uncertainty the receiver may have without the use of sampling and encoding the messages.

Secondly a similar test is conducted, this time with the use of the Radiohead library for RF communication, in order to test the communication between two Arduinos
RadioHead, which among other features include Error \textbf{Cyclic Redundancy Check} (\textbf{CRC}), should enable the driver to fix small datalosses, should this not be possible the entire packet will be dropped. 

\subsubsection{Test Setup and Result for Receiver Test}
This section will explain how the first tests were conducted and the results from it.

For the first test a receiver is connected to the Arduino.
An LED has also been connected to the Arduino as to visually show when data has been received by the Arduino.
In appendix \todo{inset code for this} the code for testing the receiver can be seen, this is used for the first test for an Arduino using the breadboard setup seen on \myref{fig:Receiver}.

\figur{Fritzing/Receiver.pdf}{1}{Breadboard view of the receiver connected to the Arduino}{Receiver}

The test was performed to see how much noise the receiver picked up without having any transmitter active. 
We measured the digital input from the data port of the receiver, meaning it was either HIGH or LOW. 
The result can be seen on graph\todo{Make graph of data.} and shows that the receiver picks up a lot of noise, the signal changed between HIGH and LOW, many times pr. second. 
This means that we must verify the integrity of the packets we send, this can be done by \gls{crc}, as it is done in RadioHead described in \myref{subsec:RadioHead}.

\subsubsection{Test Setup for the Communication Test}

For this test Radiohead and a transmitter was used along with the receiver on \myref{fig:Receiver}, the setup for the other Arduino with the transmitter be seen on \myref{fig:Transmitter}.

\figur{Fritzing/Transmitter.pdf}{1}{Breadboard view of the transmitter connected to the Arduino}{Transmitter}

The code being run on this Arduino can be seen in \myref{chp:TransmitterTestCode}.

The Arduino transmits the string \texttt{'abcdefghijklmno'} and the receiver will then receive this message, and verify that the message is exactly what was expected, if not it is thrown away.
How this message is verified can be seen on \myref{receiverCodeTest}.
The message is sent 100 times, and the number of received packages by the receiver is saved.
This test is repeated 5 times for each of the varying distances between the transmitter and receiver where the distance is always a multiple of 50 cm. 
For each distance an average of the number of packages received per test is saved for analysis.

The distance setup can be seen on \myref{fig:RFModule}, it is also important to note that the antennas on both the transmitter and the receiver is faced towards each other unobstructed throughout the test.

\tikzfigure{TransceiverTest.tex}{The setup for the test, which was run with a distance of 50cm * x, where x is an integer from 1 to 28, making the test range 50 cm to 1400 cm.}{RFModule}
\todo{Jeg synes vi bør ændre på figur tekster.. det ligner for meget bare en del af brødteksten.}

\subsubsection{Source of Errors}
The test setup was prone to several sources of errors.
It is not possible to say with guarantee which circumstances might have interfered with the test, but in the following text, possible interference on the test will be discussed.

The test was conducted in a hallway in a basement  of concrete, initial tinkering with the setup showed that placing the transceivers too close to the walls or the floor would result in weaker data transfer, while the modules were removed form both walls and floor, it is possibly that the hallway still interfered with the signal. 

Another possible source of error would be interference from other radio signals. 
Even though the tests were conducted in a basement at least some signals was known to be there, possibly many, these signals include FM radio, Wi-Fi and cellular signals.
While these signals all operate on different wavelengths the nature of RF still enables the signal to possibly interfere.

The last possibility as an error source we will discuss is the transceiver modules themselves.
These modules could be inferior in quality and therefore be source of some of the datalosses themselves, be the transmitter, the receiver or both.
This possibility is reinforced by the fact that the transmitter was tested without an antenna in order to reduce the transmission distance.

While these things could be sources for errors in the test we still deem the test useful since these circumstances does not differ much from how the setup would operate in real world circumstances, in a fire alarm for example.